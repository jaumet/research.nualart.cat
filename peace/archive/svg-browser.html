<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"">
    <link rel="shortcut icon" href="/favicon.ico">
    <title>PA-X :: Aluviat of mentions</title>
    <script type="text/javascript" src="./js/jquery.js"></script>
    <script type="text/javascript" src="./js/jquery-ui.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script type="text/javascript" src="./js/jquery.svg.pan.zoom.js"></script>
    <script>
        $( document ).ready(function() {
            $( function() {
                // Jquery-UI Dialog function:
                $("#dialog" ).dialog({
                autoOpen: false,
                show: {
                    effect: "blind",
                    duration: 1000
                },
                hide: {
                    effect: "blind",
                    duration: 1000
                }
                });
            
                $( "#opener" ).on( "click", function() {
                    $( "#dialog" ).dialog("open");
                });

                // Initial dialog
                $( "#dialog" ).dialog({
                    autoOpen: true,
                    width: 800,
                    height: 640
                });
            })
            $( "#menu" ).menu({
               position: { my: "left top", at: "right-5 top+5" }
            });
        });
    </script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

<link href="./css/jquery-ui.css" rel="stylesheet" type="text/css" media="all">
<link href="./css/jquery-ui.structure.css" rel="stylesheet" type="text/css" media="all">
<link href="./css/theme.css" rel="stylesheet" type="text/css" media="all">
<link href="./css/alluvial.css" rel="stylesheet" type="text/css" media="all">

<style>

</style>
</head>
<body>
<!--
    <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
          Menu
        </button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
        -->
        <div id="menu">
            <button class="dropdown-item" type="button" id="opener">README</button>
            <button class="dropdown-item actions" type="button" id="c00" onclick="location.reload();">All 3 Levels</button>
            <button class="dropdown-item cat" type="button" id="c99" onclick="getsvg('c99');">Only 2 levels</button>
            <button class="dropdown-item actions" type="button"  id="a1">Hide/Show flows</button>
            <div class="dropdown-divider"></div>
            <button class="dropdown-item cat" type="button" id="c01" onclick="getsvg(this);">Gender</button>
             <button class="dropdown-item cat" type="button" id="c02" onclick="getsvg(this);">Groups</button>
             <button class="dropdown-item cat" type="button" id="c03" onclick="getsvg(this);">State definition</button>
             <button class="dropdown-item cat" type="button" id="c04" onclick="getsvg(this);">Governance</button>
             <button class="dropdown-item cat" type="button" id="c05" onclick="getsvg(this);">Power-sharing</button>
             <button class="dropdown-item cat" type="button" id="c06" onclick="getsvg(this);">HR and Equality</button>
             <button class="dropdown-item cat" type="button" id="c07" onclick="getsvg(this);">Justice Sector Reform</button>
             <button class="dropdown-item cat" type="button" id="c08" onclick="getsvg(this);">Socio-Economic Reconstruction</button>
             <button class="dropdown-item cat" type="button" id="c09" onclick="getsvg(this);">Land, property, and environment</button> 
             <button class="dropdown-item cat" type="button" id="c10" onclick="getsvg(this);">Security Sector</button>
             <button class="dropdown-item cat" type="button" id="c11" onclick="getsvg(this);">Transitional Justice</button>
             <button class="dropdown-item cat" type="button" id="c12" onclick="getsvg(this);">Implementation</button
             </div>
            </div>

    <div id="svgfile" style="width:100%; overflow:auto;">
        <svg></svg>
    </div>

    <div id="dialog" title="Alluvial of mentions in PA-X">
        <h2>Welcome to the Alluvial of Mentions (AoM) in Peace Agreements database (<a href="">PA-X</a>).</h2>
        <p>AoM is a tracker of 293 categories and issues/sub-issues along the PA-X collection of peace agreements.</p>
        <p>This is a web prototype that represents the structure and the mentions of 194 categories, issues and sub-issues</p>
        <p>
            <h3>What is about:</h3>
            This site presents Alluvial diagrams (in most cases a synonym of <a href="https://en.wikipedia.org/wiki/Sankey_diagram" target="wikipedia-sankey_diagram">Sankey diagram</a>). Each diagram presents from left to right these columns: Category names > Issue names > sub-issue names. Each of the 293 names have a visual width relative to the number of Peace Agreements documents where it is mentioned.
        </p>
        <p><h3>HINTS:</h3>
            <ul>
                <li>Pan&Zoom using click and drag, and double-click. (it works better than the mouse-wheel.</li>
                <li>Click on the Category buttons to get the alluviat of one Category</li>
                <li>Click on the purple buttons to get other features, lik hide/show the flows at the diagrams, and so on.</li>
                <li>I recommend "full screen" mode, and lower the light.</li>
                <li>CHECK Category "Implementation". There is a test where tree-branches get highlighted by  mouseover. Just click the far left green  button. </li>
                <li>You can move and close this dialog. Open it again by clicking "README" from the MEnu button in the top left og this page..</li>
                <li>This is a prototype, Not yet implemented: links on the names on the diagrams, back-links to PA-X site, to Area, ... I'm trying to get a perfect zoom&pan interaction, etc  :-) </li>
                <li>Comments to jaume AT nualart.cat. This site is not yet published, this is a draft. So I, Jaume Nualart own the copyright of what I did. Soon it will be free and  easily accessible under a free licence. Comments to jaume AT nualart.cat</li>
            </ul>
        </p>
    </div>

    <script>
        console.log("Eooo!");

        // $('rect[id="klt"]').attr('width', '150');
        //$('path').css("stroke","yellow")
        //$('svg path').remove();




        // Branch highlight:
        function getlights() {
            $("rect,text").on({"mouseover": function () {
                var myclass = $(this).attr('class');
                //console.log("myclass: "+myclass+" | this:"+event.target.nodeName);
                $(".b, ."+myclass).stop(true,true).addClass("mybranch", 500);
            },
            mouseleave: function () {
                //var myclass = $(this).attr('class');
                $(".b, rect,text").stop(true,true).removeClass("mybranch", 500);
            }
            });
        }


        // Load SVG files and get them pan%zoom
        function getsvg(item) {
            if(item!="c00" && item!="c99") {
                myid = $(item).attr("id");
                var wi=1000; var he=1000;                
            } else {
                myid=item;
                var wi=2000; var he=7500;
            }
            console.log("id1: "+myid, wi, he);
            var num = myid.substring(1, 3);
            $("#svgfile").hide();
            $('#svgfile').load('./svgs/'+num+'.svg').delay(1000).promise().done(function() {
                $("svg").svgPanZoom({initialViewBox:{x:0,y:0,width:wi,height:he},maxZoom:20,zoomFactor:1});
                console.log("id2: "+myid);
                getlights();
                $('rect').attr('width', '30');
                //.css("fill","#c1c1c1");
                $('text').css("stroke","#c1c1c1");
                $("#svgfile").show('hide');
                $("svg").css("width","100%");
            })
        }
        // toggle element view
        $("#a1").click(function(){
            $("path").toggle('slow');
        });
        // Load an SVG file:
        getsvg("c00");
    </script>
    <footer></footer>
</body>
</html>